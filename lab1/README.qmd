---
title: "lab1"
format:
  md:
    output-file: README.md
editor: visual
---

## Цель работы

1.  Изучить возможности технологии Yandex Query для анализа структурированных наборов данных
2.  Получить навыки построения аналитического пайплайна для анализа данных с помощью сервисов Yandex Cloud
3.  Закрепить практические навыки использования SQL для анализа данных сетевой активности в сегментированной корпоративной сети

## Исходные данные

1.  ОС Windows
2.  Cервисы Yandex Cloud
3.  RStudio

## План

1.  Проверить доступность данных в Yandex Object Storage

2.  Подключить бакет как источник данных для Yandex Query

3.  Провести анализ данных

4.  Создать отчет

5.  **Проверьте доступность данных** (файл yaqry_dataset.pqt) в бакете arrow-datasets S3 хранилища Yandex Object Storage. Проверить можно просто перейдя по правильно сконструированному URL в браузере.

    <https://storage.yandexcloud.net/arrow-datasets/yaqry_dataset.pqt>

6.  **Подключить бакет как источник данных для Yandex Query**

Yandex Query -- это облачное решение для анализа данных, в котором задачи организации хранения, обеспечения доступа и выполнения первичного анализа данных полностью берет на себя сервис-провайдер, то есть Yandex Cloud.

-   Войдем в свой аккаунт и подключимся к Yandex Cloud

![](image/1.jpg)

-   Создадим соединение для бакета в S3 хранилище.

-   Заполняем поля с учетом допустимых символов, выбираем тип аутентификации. Вводим имя бакета в соответствующее поле и сохраняем.

    ![](image/2.jpg)

-   Настроем привязку данных

    ![](image/3.jpg)

-   Опишем состав и формат входных данных

    ![](image/4.jpg)

Формат данных

:   SCHEMA=( timestamp TIMESTAMP NOT NULL, src STRING, dst STRING, port INT32, bytes INT32 )

-   Если настройки сделаны правильно, то можно попробовать сделать аналитический запрос и посмотреть результат

![](image/5.jpg)

3.  **Провести анализ данных**

**1 Известно, что IP адреса внутренней сети начинаются с октетов, принадлежащих интервалу \[12-14\]. Определите количество хостов внутренней сети, представленных в датасете.**

```
SELECT COUNT(distinct src) AS task1
FROM `yanqusem0320`
WHERE src REGEXP '(^12\.)' or src REGEXP '(^13\.)' or src REGEXP '(^14\.)';
```

Ответ: 1000

![](image/6.jpg)

**2 Определите суммарный объем исходящего трафика**

```
SELECT sum(bytes) as task2
FROM `yanqusem0320`
WHERE (src REGEXP '(^12\.)' or src REGEXP '(^13\.)' or src REGEXP '(^14\.)') and (dst not REGEXP '(^1[2-4]\.)')
```

Ответ: 6726396441 байт

![](image/7.jpg)

**3 Определите суммарный объем входящего трафика**

```
SELECT  SUM(bytes) AS task3
FROM `yanqusem0320`
WHERE dst REGEXP '(^1[2-4].)';
```

Ответ: 15740490053 байт

![](image/8.jpg)

## Оценка результатов

Задача выполнена при помощи облачных сервисов Yandex Cloud и технологии Yandex Query, удалось познакомится с их функционалом и особенностями.

## Вывод

В данной работе я смогла закрепить практические навыки использования SQL для анализа данных сетевой активности в сегментированной корпоративной сети и получить навыки построения аналитического пайплайна для анализа данных.

```{r}
sprintf("Мы всё сделали, мы молодцы!")
```
